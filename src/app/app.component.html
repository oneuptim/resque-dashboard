<div fxLayout="column" fxFlex [class.dark-theme]="isDarkTheme">

  <md-toolbar color="primary">
    <span>Resque Dashboard</span>

    <!-- Filler that pushes the menu button to the end of the toolbar -->
    <span fxFlex></span>

    <button md-icon-button [mdMenuTriggerFor]="themeMenu">
      <md-icon>more_vert</md-icon>
    </button>

  </md-toolbar>

  <md-sidenav-container fxFlex>
    <md-sidenav mode="side" opened>
      <md-tab-group (selectChange)="selectTab($event)">
        <md-tab label="Queues" >
          <md-nav-list>         
            <md-list-item *ngFor="let item of queues" (click)="selectedItem = item; switchDetailsView = true">
              <span>{{item.title}}</span>                     
            </md-list-item>
          </md-nav-list>
        </md-tab>
        <md-tab label="Workers">
          <md-nav-list>
            <md-list-item *ngFor="let worker of workers; let i = index" (click)="selectedWorker = worker;  switchDetailsView = false">
              <span>Worker - PID {{worker.pid}}</span>                     
            </md-list-item>
          </md-nav-list>
        </md-tab>
        <md-tab label="Keys">        
          <!--<md-tab-label>
            <md-icon>vpn_key</md-icon>
          </md-tab-label>-->
          <md-nav-list>
            <!--<md-list-item *ngFor="let worker of workers; let i = index" (click)="selectedWorker = worker;  switchDetailsView = false">-->
              <!--<span>Worker - PID {{worker.pid}}</span>                     -->
            <!--</md-list-item>-->
          </md-nav-list>
        </md-tab>
      </md-tab-group>

    </md-sidenav>
    <div class="content" fxLayout="row" fxLayout.sm="column" fxLayoutGap="16px">

      <md-card fxFlex="60" *ngIf="switchDetailsView">
        <h3>{{selectedItem.title}}</h3>
        <md-divider flex></md-divider>
        <p>Queue Name <br><span>{{selectedItem.queue}}</span></p>
        <p>Size <br><span class="default">{{selectedItem.size}}</span></p>            
      </md-card>

      <md-card fxFlex="60" *ngIf="!switchDetailsView">
        <h3>Worker PID - {{selectedWorker.pid}} ({{selectedWorker.status.processing.state}})</h3> 
        <md-divider flex></md-divider>             
        <p>Host <br><span>{{selectedWorker.host}}</span></p>
        <p>PID <br><span>{{selectedWorker.pid}}</span></p>
        <p>Queues <br><span>{{selectedWorker.queues}}</span></p>
        <p>To S <br><span>{{selectedWorker.to_s}}</span></p>    
        <h2>Status</h2>
        <md-divider flex></md-divider>                
        <p>Failed<br><span class="danger">{{selectedWorker.status.failed}}</span></p>  
        <p>Heartbeat<br><span>{{selectedWorker.status.heartbeat | date:'medium'}}</span></p>
        <p>Processed<br><span>{{selectedWorker.status.processed}}</span></p>          
        <p>Started<br><span>{{selectedWorker.status.started | date:'medium'}}</span></p>
      </md-card>

      <md-card fxFlex fxLayout="column" fxLayoutGap="14px">
        <h3>Resque Stats</h3>
          <md-divider flex></md-divider>        
          <p>Pending<br><span class="warning">{{resqueObj.pending | number}}</span></p> 
          <p>Processed<br><span> {{resqueObj.processed | number}}</span></p> 
          <p>Queues<br><span> {{resqueObj.queues | number}}</span></p> 
          <p>Workers<br><span> {{resqueObj.workers | number}}</span></p> 
          <p>Working<br><span> {{resqueObj.working | number}}</span></p> 
          <p>Failed<br><span class="danger"> {{resqueObj.failed | number}}</span></p> 

      <md-divider flex></md-divider>
      </md-card>



     
      
    </div>
  </md-sidenav-container>

  <md-menu #themeMenu x-position="before">
    <button md-menu-item (click)="isDarkTheme = !isDarkTheme">Toggle Theme</button>
  </md-menu>

  <!--<button md-fab (click)="openAdminDialog()" class="fab-bottom-right">
    <md-icon>add</md-icon>
  </button>-->

</div>
